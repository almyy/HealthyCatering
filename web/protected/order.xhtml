<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

    <title>Order</title>
    <ui:composition template="../userTemplate.xhtml">
        <ui:define name="content">
            <h:form id="form">
                <p:panelGrid id="panel2" columns="2" styleClass="noBackground">
                    <p:panel style="background: none !important; border: none !important">
                        <p:fieldset id="selectedDishes" legend="Order list">  
                            <p:outputPanel id="dropArea">  
                                <h:outputText value="No dishes in order."  
                                              rendered="#{empty orderBean.dishes}"  
                                              style="font-size:15px;" />  

                                <p:dataTable var="item" value="#{orderBean.dishes}"   
                                             rendered="#{not empty orderBean.dishes}">  

                                    <p:column headerText="Count" style="width:18px" >  
                                        <h:outputText value="#{item.count}" />  
                                    </p:column>  

                                    <p:column headerText="Name">  
                                        <h:outputText value="#{item.dishName}" />  
                                    </p:column>  

                                    <p:column headerText="Unitprice" footerText="Total: #{menuitems.total_price}" style="width:25px">  
                                        <h:outputText value="#{item.price}" />  
                                    </p:column> 
                                </p:dataTable>  
                            </p:outputPanel>
                        </p:fieldset> <br /><br />
                        
                        <p:panelGrid id="panel" columns="2" style="background: #f2f2f2">
                            <f:facet name="header">  
                                Details 
                            </f:facet> 
                            <p:outputLabel value="First name:"/>
                            <p:inputText value="#{orderBean.user.firstName}" required="true"></p:inputText>
                            <p:outputLabel value="Surname:"/>
                            <p:inputText value="#{orderBean.user.surname}" required="true"></p:inputText>
                            <p:outputLabel value="Address:"/>
                            <p:inputText value="#{orderBean.user.address}" required="true"></p:inputText>
                            <p:outputLabel value="Postalcode:"/>
                            <p:inputText value="#{orderBean.user.postnumber}" required="true"></p:inputText>
                            <p:outputLabel value="Phone number:"/>
                            <p:inputText value="#{orderBean.user.phone}" required="true"></p:inputText>
                            <p:outputLabel value="Email:"/>
                            <p:inputText value="#{orderBean.user.email}" required="true" requiredMessage="Email is required."></p:inputText>
                        </p:panelGrid>
                        <p:message for="panel"></p:message>
                        
                    </p:panel>

                    <p:panel style="background: none !important; border: none !important">
                        <p:outputLabel value="Date:"/><br />
                        <p:calendar effect="drop" value="#{orderBean.deliverydate}" readonly="true" timeZone="#{orderBean.timeZone}" mindate="#{orderBean.deliverydate}"/><br /><br />
                        <p:outputLabel value="Time:"/><br />
                        <p:selectOneMenu value="#{orderBean.deliverydate.hours}" valueChangeListener="submit()">
                            <f:selectItems value="#{orderBean.hourvalues}"></f:selectItems>
                        </p:selectOneMenu>
                        <p:selectOneMenu value="#{orderBean.deliverydate.minutes}" valueChangeListener="submit()">
                            <f:selectItems value="#{orderBean.minutevalues}"></f:selectItems>    
                        </p:selectOneMenu><br /><br />
                        
                        Add description:<br />
                        <p:inputTextarea rows="5" cols="30" counter="counter" maxlength="100"       
                                         counterTemplate="{0} characters remaining." value="#{orderBean.description}"/><br />
                        <h:outputText id="counter"/><br /><br />
                        
                        <p:captcha id="captcha" label="Captcha" language="en" theme="white" requiredMessage="Please enter the two words." validatorMessage="Captcha answer was incorrect."/><br />
                        <p:message for="captcha"></p:message><br />
                    </p:panel>
                </p:panelGrid>
                <p:commandButton value="Send" action="#{orderBean.confirmOrder()}" ajax="false"></p:commandButton>
                <p:commandButton value="Subscribe" action ="#{orderBean.subscribe()}" ajax="false"></p:commandButton>
            </h:form>
        </ui:define>
    </ui:composition>
</html>

